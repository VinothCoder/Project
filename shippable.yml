language: node_js

node_js:
  - 6.11.0

before_install:
  - source ~/.nvm/nvm.sh && nvm install $SHIPPABLE_NODE_VERSION
  - node --version
  - npm install
  - sleep 2s
  - shippable_retry sudo npm install -g now
  - sleep 2s

build:
  ci:
    - npm start &
    - npm test

  on_success:
    - if [ "$BRANCH" == "master" ] && [ "$IS_PULL_REQUEST" == false ]; then
      bash ./dev-scripts/deploy.sh
      fi

notifications:
  - email: true

cache: true

cache_dir_list:
  - $SHIPPABLE_BUILD_DIR/node_modules
